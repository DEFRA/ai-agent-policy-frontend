{% extends 'layouts/page.njk' %}

{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/details/macro.njk" import govukDetails %}

{% block content %}
  {{ appHeading({
    text: heading,
    caption: "An agentic generative AI workflow that helps draft parliamentary questions by analyzing past PQs and generating high-quality responses."
  }) }}

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      
      {# Primary call-to-action section #}
      <div class="govuk-inset-text" data-testid="app-main-cta">
        <h2 class="govuk-heading-m">Submit a Parliamentary Question</h2>
        <p class="govuk-body">
          Get AI-powered assistance to draft high-quality parliamentary question responses based on past PQs and policy documents.
        </p>
        
        <a href="/parliamentary-question" 
           role="button" 
           draggable="false" 
           class="govuk-button govuk-button--start" 
           data-module="govuk-button"
           data-testid="submit-question-button">
          Submit a question
          <svg class="govuk-button__start-icon" xmlns="http://www.w3.org/2000/svg" width="17.5" height="19" viewBox="0 0 33 40" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M0 0h13l20 20-20 20H0l20-20z"/>
          </svg>
        </a>
      </div>

      {# View previous analysis section #}
      <div class="govuk-inset-text" data-testid="app-view-analysis">
        <h2 class="govuk-heading-s">View Previous Analysis</h2>
        <p class="govuk-body-s">
          Already submitted a question? Enter your analysis code to view detailed results.
        </p>
        
        <form action="/semantic-output" method="post" class="govuk-!-margin-bottom-0" data-testid="analysis-code-form">
          <div class="govuk-form-group">
            {{ govukInput({
              name: "code",
              id: "analysis-code",
              label: {
                text: "Analysis code",
                classes: "govuk-label--s govuk-visually-hidden"
              },
              hint: {
                text: "Enter the code provided after submitting your question"
              },
              attributes: {
                "placeholder": "Enter analysis code",
                "data-testid": "analysis-code-input"
              }
            }) }}
          </div>
          
          {{ govukButton({
            text: "View analysis",
            type: "submit",
            classes: "govuk-button--secondary",
            attributes: {
              "data-testid": "view-analysis-button"
            }
          }) }}
        </form>
      </div>

      {# How it works section #}
      {{ govukDetails({
        summaryText: "How it works",
        html: '
          <p>When you submit a parliamentary question, our AI system will:</p>
          <ul class="govuk-list govuk-list--bullet">
            <li>Search through existing policy documents and past PQs</li>
            <li>Find relevant information and precedents</li>
            <li>Filter and highlight key information</li>
            <li>Generate a draft response based on past examples</li>
            <li>Quality check the response for tone, facts, and clarity</li>
            <li>Adapt and improve based on quality assessment</li>
            <li>Provide a template answer with supporting information</li>
          </ul>
          <p class="govuk-body-s">This service is designed to assist with parliamentary question preparation and does not replace official guidance or procedures.</p>
        '
      }) }}

    </div>
  </div>

{% endblock %}
